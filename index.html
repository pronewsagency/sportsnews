<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>أخبار محليات – FootballGallery</title>
  <style>
    body { font-family: "Tajawal", sans-serif; background:#f4f4f4; padding:20px; }
    h1 { text-align:center; color:#333; margin-bottom:20px; }
    .news-card {
      display:flex; gap:12px; background:#fff; padding:12px;
      border-radius:8px; margin-bottom:12px;
      box-shadow:0 1px 4px rgba(0,0,0,0.1);
      cursor:pointer; transition:0.3s;
    }
    .news-card:hover { transform:scale(1.02); }
    .news-card img {
      width:120px; height:80px; object-fit:cover; border-radius:6px;
    }
    .news-info h3 { margin:0 0 6px; font-size:17px; color:#222; }
    .news-info span { display:block; color:#555; font-size:13px; margin-bottom:6px; }
  </style>
</head>
<body>
  <h1>أخبار قسم "محليات"</h1>
  <div id="news-container">⏳ جاري التحميل...</div>

  <script>
    const baseUrl = "https://www.footballgallery.net";
    const targetUrl = baseUrl + "/ar/section/%D9%85%D8%AD%D9%84%D9%8A%D8%A7%D8%AA";
    const proxy = "https://api.allorigins.win/get?url=" + encodeURIComponent(targetUrl);

    fetch(proxy)
      .then(res => res.json())
      .then(data => {
        const doc = new DOMParser().parseFromString(data.contents, "text/html");
        const items = doc.querySelectorAll(".news-initial-box");
        const container = document.getElementById("news-container");
        container.innerHTML = "";

        items.forEach((box, index) => {
          const anchor = box.querySelector("a.list-item-wrapper");
          const title = box.querySelector("h3")?.textContent.trim() || "بدون عنوان";
          const date = box.querySelector(".dates-sec span")?.textContent.trim() || "";
          const imgSrc = box.querySelector("img")?.getAttribute("data-src") || "";
          const link = anchor ? new URL(anchor.getAttribute("href"), baseUrl).href : "#";

          container.innerHTML += `
          <div class="news-card" onclick="openNews('${encodeURIComponent(link)}')">
            <img src="${imgSrc.startsWith('http') ? imgSrc : baseUrl+imgSrc}" alt="${title}">
            <div class="news-info">
              <h3>${title}</h3>
              <span>🗓 ${date}</span>
            </div>
          </div>`;
        });

        if (items.length === 0) {
          container.innerHTML = "⚠️ لا توجد أخبار في هذا القسم.";
        }
      })
      .catch(err => {
        document.getElementById("news-container").innerHTML =
          "❌ خطأ أثناء جلب الأخبار: " + err;
      });

    function openNews(url) {
      // نفتح صفحة تفاصيل مع الرابط كـ query parameter
      window.location.href = "news-detail.html?link=" + encodeURIComponent(url);
    }
  </script>
</body>
</html>
